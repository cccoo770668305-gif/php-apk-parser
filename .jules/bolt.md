## 2025-05-15 - Stream copying optimization
**Learning:** Manual loops for copying streams (especially 1-byte or small buffer loops) are extremely slow in PHP due to high function call overhead. `stream_copy_to_stream()` is significantly faster (~133x in this case) and more memory-efficient. Also, reassigning a variable that holds a resource to an object makes `is_resource()` checks on that variable fail, leading to logic bugs in resource management.
**Action:** Always prefer `stream_copy_to_stream()` for stream-to-stream data transfer. Be careful with variable shadowing or reassignment when managing resources that need to be closed conditionally.
